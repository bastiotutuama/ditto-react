# Ditto React

`ditto-react` makes it easy to integrate a React app with Ditto. 
- Exposes Ditto data to your application through an easy-to-wrap provider
- Offers support for localizing using Ditto variants
- Works hand-in-hand with the [Ditto CLI](https://github.com/dittowords/cli)

## Installation

You can install `ditto-react` from npm:

```bash
# as a dev dependency (recommended)
npm install --save-dev ditto-react
```

## Getting Started

### Set up the CLI
First, you'll need to set up the [Ditto CLI](https://github.com/dittowords/cli) in your repository; initialize the CLI in a place that is accessible to your React code.

For example, if you have a project created with [create-react-app](https://github.com/facebook/create-react-app), initialize the CLI in the `src` folder, because directories outside of it can't be imported from your application. See the [Ditto CLI's README](https://github.com/dittowords/cli) for more information on how to set it up and start syncing data from your workspace.

NOTE: We strongly recommend syncing with your component library over individual projects(TODO: link here to example project, which maybe explains the rationale?)

### Set up the provider
At the root of your application, import and wrap your app in `DittoProvider`; pass its `source` prop data imported from the `ditto` folder generated by the CLI:
```jsx
import DittoProvider from 'ditto-react';
import dittoData from './ditto';

const App = () => (
  <DittoProvider source={dittoData}>
    ...
  </DittoProvider>
)
```

### Start implementing text components
Anywhere in your application that requires product copy, import and use the `Ditto` component:

```jsx
import { Ditto } from 'ditto-react';

const HomePage = () => (
  <div>
    <h1><Ditto componentId="home.title" /></h1> 
    <h2><Ditto componentId="home.subtitle"></h2>
    <p>
      <Ditto componentId="home.body" />
    </p>
    <footer>
      <ul>
        <li>
          <a href="/home"><Ditto componentId="footer.links.home" /></a>
        </li>
        <li>
          <a href="/contact"><Ditto componentId="footer.links.contact" /></a>
        </li>
        <li>
          <a href="/about"><Ditto componentId="footer.links.about" /></a>
        </li>
      </ul>
    </footer>
  </div>
)
```

1. Setup the  (refer to that repository's README for detailed instructions)
2. Pull data using the CLI in a central place in your repository that is accessible to your React code. 
3. At the root of your React app, import your data from the CLI-created `ditto` folder and import `DittoProvider` from `ditto-react`:
4. Wrap your application in `DittoProvider`, passing to its `source` prop the data imported from the `ditto` folder:
```jsx
const App = () => (
  <DittoProvider source={dittoData}>
    ...
  </DittoProvider>
)
```


---

## Usage

### DittoProvider

The `DittoProvider` component should wrap any parts of your app you'd like to use `Ditto` components in; it needs to specify where any descendent `Ditto` components should pull text from.

#### DittoProvider Props

| Prop | Type | Description |
| --- | --- | --- |
| `source` | JSON (required) | product copy to be used by Ditto wherever DittoProvider wraps — see Source (link to bottom) for more info  |
| `projectId` | String (optional) | ID of a project in Ditto; can alternatively be passed/overwritten with a prop passed directly to `Ditto` components


#### DittoProvider Example

```jsx
import DittoProvider from 'ditto-react';
import source from "/.ditto/text.json";

<DittoProvider projectId="my_project" source={source}>
	{/* insert any app components here,
	including Ditto components and regular
	React components */}
</DittoProvider>
```

### Ditto


#### Ditto Props

`Ditto` is used to fetch specific text, blocks, and frames from the source. You must specify at least a `textId` or a `frameId`.


| Prop | Type | Description | Example |
| --- | --- | --- | --- |
| `frameId` | string (optional) | ID of a frame in Ditto |  |
| `blockId` | string (optional) | ID of a block in Ditto |  |
| `textId` | string (optional) | ID of a single text item in Ditto |  |
| `filters` | object (optional) | object of filters for text items returned. Currently supports a single parameter: tags, an array of tag strings | { tags: ["SELECTS"]} |
| `projectId` | string (semi-optional) | ID of a project in Ditto; only optional if `projectId` has been passed to `DittoProvider`


### Example: Single Text

The `Ditto` component can be used to fetch a specific text item from the Ditto project using its unique ID. Note that you can edit IDs for text, blocks, and frames directly in our web-app.

```jsx
<Ditto textId="text_601cc35c5bsdfe42cc3f6f8ac59"/>
```

### Example: Fetch Block

You can also fetch an entire Block in Ditto at once by specifying the `frameId` and the `blockId`.

It will return as an entire JSON object of the frame. You can pull out specific IDs of text you'd like to pass to its children.

```jsx
<Ditto frameId="frame_601cc35d5be42cc3f6f8ad15" blockId="hero">
  {({
    hero_h1, text_601cc35c5be42cc3f6f8ac46, hero_cta
  }) => (
    <div>
      <h1>{hero_h1}</h1>
      <h2>{text_601cc35c5be42cc3f6f8ac46}</h2>
      <button>{hero_cta}</button>
    </div>
  )}
</Ditto>
```

You can also iterate through the entire block (just as you can with any other object) to display each one.

```jsx
<Ditto
    frameId="header"
    blockId="navigation"
  >
    {( block ) => {
      return Object.keys(block).map((id) => (
        <div key={block[id]}>{block[id]}</div>
      ));
    }}
  </Ditto>
```

### Example: Fetch Frame

You can also fetch an entire Block in Ditto at once by just specifying the `frameId`. With it, you can fetch specific blocks, or iterate through all blocks and containing IDs as needed.

```jsx
<Ditto
  frameId="frame_601cc35d5be42cc3f6f8ad17"
>
  {( frame ) => {
    return Object.keys(frame.blocks).map((blockId) => (
      <div className={style.footerCol} key={blockId}>
        {
          Object.keys(frame.blocks[blockId]).map((textId) => (
            <div className={style.link} key={textId}>
              {frame.blocks[blockId][textId]}
            </div>
          ))
        }
      </div>
    ));
  }}
</Ditto>
```

### Example: Filtering by Tags

If you want to filter the text fetched by properties contained in the project itself, you can specify parameters to the `filter` prop of the `Ditto` component. This currently only supports the Tags field in Ditto, but will be expanded in the future to filter on any other metadata properties.

```jsx
// will only return text with the "TOP_NAV" tag
<Ditto
  frameId="frame_601cc35d5be42cc3f6f8ad15"
  blockId="navigation"
  filters={{ tags: ["TOP_NAV"]}}
>
  {( block ) => {
    return Object.keys(block).map((id) => (
      <div className={style.link} key={block[id]}>{block[id]}</div>
    ));
  }}
</Ditto>
```

---

## Source

The React provider takes structured JSON outputs from Ditto projects as the source. These can be linked and automatically updated via [our API/CLI](https://github.com/dittowords/cli), or exported manually via our web-app.

If you're using manual exports from our web-app, turn on Developer Mode in the toolbar of project you're working from to generate IDs. Then, export your file formatted with the IDs into your local directory .

---

## Feedback

Have feedback? We’d love to hear it! Ditto's developer integrations are constantly being improved by feedback from users like you. :)

Message us at [support@dittowords.com](mailto:support@dittowords.com).

